use cfb;

MERGE cfb.dbo.advanced_game_stats AS target
USING cfb_load.dbo.advanced_game_stats AS source
ON target.game_id = source.game_id AND target.team = source.team
WHEN MATCHED THEN
    UPDATE SET
        season = source.season,
        week = source.week,
        opponent = source.opponent,
        offense_passing_plays_explosiveness = source.offense_passing_plays_explosiveness,
        offense_passing_plays_success_rate = source.offense_passing_plays_success_rate,
        offense_passing_plays_total_ppa = source.offense_passing_plays_total_ppa,
        offense_passing_plays_ppa = source.offense_passing_plays_ppa,
        offense_rushing_plays_explosiveness = source.offense_rushing_plays_explosiveness,
        offense_rushing_plays_success_rate = source.offense_rushing_plays_success_rate,
        offense_rushing_plays_total_ppa = source.offense_rushing_plays_total_ppa,
        offense_rushing_plays_ppa = source.offense_rushing_plays_ppa,
        offense_passing_downs_explosiveness = source.offense_passing_downs_explosiveness,
        offense_passing_downs_success_rate = source.offense_passing_downs_success_rate,
        offense_passing_downs_ppa = source.offense_passing_downs_ppa,
        offense_standard_downs_explosiveness = source.offense_standard_downs_explosiveness,
        offense_standard_downs_success_rate = source.offense_standard_downs_success_rate,
        offense_standard_downs_ppa = source.offense_standard_downs_ppa,
        offense_open_field_yards_total = source.offense_open_field_yards_total,
        offense_open_field_yards = source.offense_open_field_yards,
        offense_second_level_yards_total = source.offense_second_level_yards_total,
        offense_second_level_yards = source.offense_second_level_yards,
        offense_line_yards_total = source.offense_line_yards_total,
        offense_line_yards = source.offense_line_yards,
        offense_stuff_rate = source.offense_stuff_rate,
        offense_power_success = source.offense_power_success,
        offense_explosiveness = source.offense_explosiveness,
        offense_success_rate = source.offense_success_rate,
        offense_total_ppa = source.offense_total_ppa,
        offense_ppa = source.offense_ppa,
        offense_drives = source.offense_drives,
        offense_plays = source.offense_plays,
        defense_passing_plays_explosiveness = source.defense_passing_plays_explosiveness,
        defense_passing_plays_success_rate = source.defense_passing_plays_success_rate,
        defense_passing_plays_total_ppa = source.defense_passing_plays_total_ppa,
        defense_passing_plays_ppa = source.defense_passing_plays_ppa,
        defense_rushing_plays_explosiveness = source.defense_rushing_plays_explosiveness,
        defense_rushing_plays_success_rate = source.defense_rushing_plays_success_rate,
        defense_rushing_plays_total_ppa = source.defense_rushing_plays_total_ppa,
        defense_rushing_plays_ppa = source.defense_rushing_plays_ppa,
        defense_passing_downs_explosiveness = source.defense_passing_downs_explosiveness,
        defense_passing_downs_success_rate = source.defense_passing_downs_success_rate,
        defense_passing_downs_ppa = source.defense_passing_downs_ppa,
        defense_standard_downs_explosiveness = source.defense_standard_downs_explosiveness,
        defense_standard_downs_success_rate = source.defense_standard_downs_success_rate,
        defense_standard_downs_ppa = source.defense_standard_downs_ppa,
        defense_open_field_yards_total = source.defense_open_field_yards_total,
        defense_open_field_yards = source.defense_open_field_yards,
        defense_second_level_yards_total = source.defense_second_level_yards_total,
        defense_second_level_yards = source.defense_second_level_yards,
        defense_line_yards_total = source.defense_line_yards_total,
        defense_line_yards = source.defense_line_yards,
        defense_stuff_rate = source.defense_stuff_rate,
        defense_power_success = source.defense_power_success,
        defense_explosiveness = source.defense_explosiveness,
        defense_success_rate = source.defense_success_rate,
        defense_total_ppa = source.defense_total_ppa,
        defense_ppa = source.defense_ppa,
        defense_drives = source.defense_drives,
        defense_plays = source.defense_plays
WHEN NOT MATCHED THEN
    INSERT (
        game_id,
        season,
        week,
        team,
        opponent,
        offense_passing_plays_explosiveness,
        offense_passing_plays_success_rate,
        offense_passing_plays_total_ppa,
        offense_passing_plays_ppa,
        offense_rushing_plays_explosiveness,
        offense_rushing_plays_success_rate,
        offense_rushing_plays_total_ppa,
        offense_rushing_plays_ppa,
        offense_passing_downs_explosiveness,
        offense_passing_downs_success_rate,
        offense_passing_downs_ppa,
        offense_standard_downs_explosiveness,
        offense_standard_downs_success_rate,
        offense_standard_downs_ppa,
        offense_open_field_yards_total,
        offense_open_field_yards,
        offense_second_level_yards_total,
        offense_second_level_yards,
        offense_line_yards_total,
        offense_line_yards,
        offense_stuff_rate,
        offense_power_success,
        offense_explosiveness,
        offense_success_rate,
        offense_total_ppa,
        offense_ppa,
        offense_drives,
        offense_plays,
        defense_passing_plays_explosiveness,
        defense_passing_plays_success_rate,
        defense_passing_plays_total_ppa,
        defense_passing_plays_ppa,
        defense_rushing_plays_explosiveness,
        defense_rushing_plays_success_rate,
        defense_rushing_plays_total_ppa,
        defense_rushing_plays_ppa,
        defense_passing_downs_explosiveness,
        defense_passing_downs_success_rate,
        defense_passing_downs_ppa,
        defense_standard_downs_explosiveness,
        defense_standard_downs_success_rate,
        defense_standard_downs_ppa,
        defense_open_field_yards_total,
        defense_open_field_yards,
        defense_second_level_yards_total,
        defense_second_level_yards,
        defense_line_yards_total,
        defense_line_yards,
        defense_stuff_rate,
        defense_power_success,
        defense_explosiveness,
        defense_success_rate,
        defense_total_ppa,
        defense_ppa,
        defense_drives,
        defense_plays
    )
    VALUES (
        source.game_id,
        source.season,
        source.week,
        source.team,
        source.opponent,
        source.offense_passing_plays_explosiveness,
        source.offense_passing_plays_success_rate,
        source.offense_passing_plays_total_ppa,
        source.offense_passing_plays_ppa,
        source.offense_rushing_plays_explosiveness,
        source.offense_rushing_plays_success_rate,
        source.offense_rushing_plays_total_ppa,
        source.offense_rushing_plays_ppa,
        source.offense_passing_downs_explosiveness,
        source.offense_passing_downs_success_rate,
        source.offense_passing_downs_ppa,
        source.offense_standard_downs_explosiveness,
        source.offense_standard_downs_success_rate,
        source.offense_standard_downs_ppa,
        source.offense_open_field_yards_total,
        source.offense_open_field_yards,
        source.offense_second_level_yards_total,
        source.offense_second_level_yards,
        source.offense_line_yards_total,
        source.offense_line_yards,
        source.offense_stuff_rate,
        source.offense_power_success,
        source.offense_explosiveness,
        source.offense_success_rate,
        source.offense_total_ppa,
        source.offense_ppa,
        source.offense_drives,
        source.offense_plays,
        source.defense_passing_plays_explosiveness,
        source.defense_passing_plays_success_rate,
        source.defense_passing_plays_total_ppa,
        source.defense_passing_plays_ppa,
        source.defense_rushing_plays_explosiveness,
        source.defense_rushing_plays_success_rate,
        source.defense_rushing_plays_total_ppa,
        source.defense_rushing_plays_ppa,
        source.defense_passing_downs_explosiveness,
        source.defense_passing_downs_success_rate,
        source.defense_passing_downs_ppa,
        source.defense_standard_downs_explosiveness,
        source.defense_standard_downs_success_rate,
        source.defense_standard_downs_ppa,
        source.defense_open_field_yards_total,
        source.defense_open_field_yards,
        source.defense_second_level_yards_total,
        source.defense_second_level_yards,
        source.defense_line_yards_total,
        source.defense_line_yards,
        source.defense_stuff_rate,
        source.defense_power_success,
        source.defense_explosiveness,
        source.defense_success_rate,
        source.defense_total_ppa,
        source.defense_ppa,
        source.defense_drives,
        source.defense_plays
    );

truncate table cfb_load.dbo.advanced_game_stats