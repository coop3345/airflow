USE cfb_load;

SET IDENTITY_INSERT cfb.dbo.games ON;

MERGE INTO cfb.dbo.games AS target
USING cfb_load.dbo.games AS source
ON target.id = source.id
WHEN MATCHED THEN
    UPDATE SET
        season = source.season,
        week = source.week,
        season_type = source.season_type,
        start_date = source.start_date,
        start_time_tbd = source.start_time_tbd,
        completed = source.completed,
        neutral_site = source.neutral_site,
        conference_game = source.conference_game,
        attendance = source.attendance,
        venue_id = source.venue_id,
        venue = source.venue,
        home_id = source.home_id,
        home_team = source.home_team,
        home_conference = source.home_conference,
        home_classification = source.home_classification,
        home_points = source.home_points,
        home_line_scores = source.home_line_scores,
        home_postgame_win_probability = source.home_postgame_win_probability,
        home_pregame_elo = source.home_pregame_elo,
        home_postgame_elo = source.home_postgame_elo,
        away_id = source.away_id,
        away_team = source.away_team,
        away_conference = source.away_conference,
        away_classification = source.away_classification,
        away_points = source.away_points,
        away_line_scores = source.away_line_scores,
        away_postgame_win_probability = source.away_postgame_win_probability,
        away_pregame_elo = source.away_pregame_elo,
        away_postgame_elo = source.away_postgame_elo,
        excitement_index = source.excitement_index,
        highlights = source.highlights,
        notes = source.notes
WHEN NOT MATCHED THEN
    INSERT (
        id,
        season,
        week,
        season_type,
        start_date,
        start_time_tbd,
        completed,
        neutral_site,
        conference_game,
        attendance,
        venue_id,
        venue,
        home_id,
        home_team,
        home_conference,
        home_classification,
        home_points,
        home_line_scores,
        home_postgame_win_probability,
        home_pregame_elo,
        home_postgame_elo,
        away_id,
        away_team,
        away_conference,
        away_classification,
        away_points,
        away_line_scores,
        away_postgame_win_probability,
        away_pregame_elo,
        away_postgame_elo,
        excitement_index,
        highlights,
        notes
    )
    VALUES (
        source.id,
        source.season,
        source.week,
        source.season_type,
        source.start_date,
        source.start_time_tbd,
        source.completed,
        source.neutral_site,
        source.conference_game,
        source.attendance,
        source.venue_id,
        source.venue,
        source.home_id,
        source.home_team,
        source.home_conference,
        source.home_classification,
        source.home_points,
        source.home_line_scores,
        source.home_postgame_win_probability,
        source.home_pregame_elo,
        source.home_postgame_elo,
        source.away_id,
        source.away_team,
        source.away_conference,
        source.away_classification,
        source.away_points,
        source.away_line_scores,
        source.away_postgame_win_probability,
        source.away_pregame_elo,
        source.away_postgame_elo,
        source.excitement_index,
        source.highlights,
        source.notes
    );

TRUNCATE TABLE cfb_load.dbo.games;