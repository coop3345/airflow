USE cfb_load;

MERGE cfb.dbo.drives AS target
USING cfb_load.dbo.drives AS source
ON target.id = source.id
WHEN MATCHED THEN
    UPDATE SET
        offense = source.offense,
        offense_conference = source.offense_conference,
        defense = source.defense,
        defense_conference = source.defense_conference,
        game_id = source.game_id,
        drive_number = source.drive_number,
        scoring = source.scoring,
        start_period = source.start_period,
        start_yardline = source.start_yardline,
        start_yards_to_goal = source.start_yards_to_goal,
        start_minutes = source.start_minutes,
        start_seconds = source.start_seconds,
        end_period = source.end_period,
        end_yardline = source.end_yardline,
        end_yards_to_goal = source.end_yards_to_goal,
        end_minutes = source.end_minutes,
        end_seconds = source.end_seconds,
        elapsed_minutes = source.elapsed_minutes,
        elapsed_seconds = source.elapsed_seconds,
        plays = source.plays,
        yards = source.yards,
        drive_result = source.drive_result,
        is_home_offense = source.is_home_offense,
        start_offense_score = source.start_offense_score,
        start_defense_score = source.start_defense_score,
        end_offense_score = source.end_offense_score,
        end_defense_score = source.end_defense_score
WHEN NOT MATCHED THEN
    INSERT (
        id,
        offense,
        offense_conference,
        defense,
        defense_conference,
        game_id,
        drive_number,
        scoring,
        start_period,
        start_yardline,
        start_yards_to_goal,
        start_minutes,
        start_seconds,
        end_period,
        end_yardline,
        end_yards_to_goal,
        end_minutes,
        end_seconds,
        elapsed_minutes,
        elapsed_seconds,
        plays,
        yards,
        drive_result,
        is_home_offense,
        start_offense_score,
        start_defense_score,
        end_offense_score,
        end_defense_score
    )
    VALUES (
        source.id,
        source.offense,
        source.offense_conference,
        source.defense,
        source.defense_conference,
        source.game_id,
        source.drive_number,
        source.scoring,
        source.start_period,
        source.start_yardline,
        source.start_yards_to_goal,
        source.start_minutes,
        source.start_seconds,
        source.end_period,
        source.end_yardline,
        source.end_yards_to_goal,
        source.end_minutes,
        source.end_seconds,
        source.elapsed_minutes,
        source.elapsed_seconds,
        source.plays,
        source.yards,
        source.drive_result,
        source.is_home_offense,
        source.start_offense_score,
        source.start_defense_score,
        source.end_offense_score,
        source.end_defense_score
    );

TRUNCATE TABLE cfb_load.dbo.drives;